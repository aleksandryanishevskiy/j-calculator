"use strict";

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/*! jQuery UI - v1.12.1 - 2018-05-02
* http://jqueryui.com
* Includes: widget.js, keycode.js, widgets/mouse.js, widgets/slider.js
* Copyright jQuery Foundation and other contributors; Licensed MIT */
(function (t) {
  "function" == typeof define && define.amd ? define(["jquery"], t) : t(jQuery);
})(function (t) {
  t.ui = t.ui || {}, t.ui.version = "1.12.1";
  var e = 0,
      i = Array.prototype.slice;
  t.cleanData = function (e) {
    return function (i) {
      var s, n, o;

      for (o = 0; null != (n = i[o]); o++) {
        try {
          s = t._data(n, "events"), s && s.remove && t(n).triggerHandler("remove");
        } catch (a) {}
      }

      e(i);
    };
  }(t.cleanData), t.widget = function (e, i, s) {
    var n,
        o,
        a,
        r = {},
        l = e.split(".")[0];
    e = e.split(".")[1];
    var h = l + "-" + e;
    return s || (s = i, i = t.Widget), t.isArray(s) && (s = t.extend.apply(null, [{}].concat(s))), t.expr[":"][h.toLowerCase()] = function (e) {
      return !!t.data(e, h);
    }, t[l] = t[l] || {}, n = t[l][e], o = t[l][e] = function (t, e) {
      return this._createWidget ? (arguments.length && this._createWidget(t, e), void 0) : new o(t, e);
    }, t.extend(o, n, {
      version: s.version,
      _proto: t.extend({}, s),
      _childConstructors: []
    }), a = new i(), a.options = t.widget.extend({}, a.options), t.each(s, function (e, s) {
      return t.isFunction(s) ? (r[e] = function () {
        function t() {
          return i.prototype[e].apply(this, arguments);
        }

        function n(t) {
          return i.prototype[e].apply(this, t);
        }

        return function () {
          var e,
              i = this._super,
              o = this._superApply;
          return this._super = t, this._superApply = n, e = s.apply(this, arguments), this._super = i, this._superApply = o, e;
        };
      }(), void 0) : (r[e] = s, void 0);
    }), o.prototype = t.widget.extend(a, {
      widgetEventPrefix: n ? a.widgetEventPrefix || e : e
    }, r, {
      constructor: o,
      namespace: l,
      widgetName: e,
      widgetFullName: h
    }), n ? (t.each(n._childConstructors, function (e, i) {
      var s = i.prototype;
      t.widget(s.namespace + "." + s.widgetName, o, i._proto);
    }), delete n._childConstructors) : i._childConstructors.push(o), t.widget.bridge(e, o), o;
  }, t.widget.extend = function (e) {
    for (var s, n, o = i.call(arguments, 1), a = 0, r = o.length; r > a; a++) {
      for (s in o[a]) {
        n = o[a][s], o[a].hasOwnProperty(s) && void 0 !== n && (e[s] = t.isPlainObject(n) ? t.isPlainObject(e[s]) ? t.widget.extend({}, e[s], n) : t.widget.extend({}, n) : n);
      }
    }

    return e;
  }, t.widget.bridge = function (e, s) {
    var n = s.prototype.widgetFullName || e;

    t.fn[e] = function (o) {
      var a = "string" == typeof o,
          r = i.call(arguments, 1),
          l = this;
      return a ? this.length || "instance" !== o ? this.each(function () {
        var i,
            s = t.data(this, n);
        return "instance" === o ? (l = s, !1) : s ? t.isFunction(s[o]) && "_" !== o.charAt(0) ? (i = s[o].apply(s, r), i !== s && void 0 !== i ? (l = i && i.jquery ? l.pushStack(i.get()) : i, !1) : void 0) : t.error("no such method '" + o + "' for " + e + " widget instance") : t.error("cannot call methods on " + e + " prior to initialization; " + "attempted to call method '" + o + "'");
      }) : l = void 0 : (r.length && (o = t.widget.extend.apply(null, [o].concat(r))), this.each(function () {
        var e = t.data(this, n);
        e ? (e.option(o || {}), e._init && e._init()) : t.data(this, n, new s(o, this));
      })), l;
    };
  }, t.Widget = function () {}, t.Widget._childConstructors = [], t.Widget.prototype = {
    widgetName: "widget",
    widgetEventPrefix: "",
    defaultElement: "<div>",
    options: {
      classes: {},
      disabled: !1,
      create: null
    },
    _createWidget: function _createWidget(i, s) {
      s = t(s || this.defaultElement || this)[0], this.element = t(s), this.uuid = e++, this.eventNamespace = "." + this.widgetName + this.uuid, this.bindings = t(), this.hoverable = t(), this.focusable = t(), this.classesElementLookup = {}, s !== this && (t.data(s, this.widgetFullName, this), this._on(!0, this.element, {
        remove: function remove(t) {
          t.target === s && this.destroy();
        }
      }), this.document = t(s.style ? s.ownerDocument : s.document || s), this.window = t(this.document[0].defaultView || this.document[0].parentWindow)), this.options = t.widget.extend({}, this.options, this._getCreateOptions(), i), this._create(), this.options.disabled && this._setOptionDisabled(this.options.disabled), this._trigger("create", null, this._getCreateEventData()), this._init();
    },
    _getCreateOptions: function _getCreateOptions() {
      return {};
    },
    _getCreateEventData: t.noop,
    _create: t.noop,
    _init: t.noop,
    destroy: function destroy() {
      var e = this;
      this._destroy(), t.each(this.classesElementLookup, function (t, i) {
        e._removeClass(i, t);
      }), this.element.off(this.eventNamespace).removeData(this.widgetFullName), this.widget().off(this.eventNamespace).removeAttr("aria-disabled"), this.bindings.off(this.eventNamespace);
    },
    _destroy: t.noop,
    widget: function widget() {
      return this.element;
    },
    option: function option(e, i) {
      var s,
          n,
          o,
          a = e;
      if (0 === arguments.length) return t.widget.extend({}, this.options);
      if ("string" == typeof e) if (a = {}, s = e.split("."), e = s.shift(), s.length) {
        for (n = a[e] = t.widget.extend({}, this.options[e]), o = 0; s.length - 1 > o; o++) {
          n[s[o]] = n[s[o]] || {}, n = n[s[o]];
        }

        if (e = s.pop(), 1 === arguments.length) return void 0 === n[e] ? null : n[e];
        n[e] = i;
      } else {
        if (1 === arguments.length) return void 0 === this.options[e] ? null : this.options[e];
        a[e] = i;
      }
      return this._setOptions(a), this;
    },
    _setOptions: function _setOptions(t) {
      var e;

      for (e in t) {
        this._setOption(e, t[e]);
      }

      return this;
    },
    _setOption: function _setOption(t, e) {
      return "classes" === t && this._setOptionClasses(e), this.options[t] = e, "disabled" === t && this._setOptionDisabled(e), this;
    },
    _setOptionClasses: function _setOptionClasses(e) {
      var i, s, n;

      for (i in e) {
        n = this.classesElementLookup[i], e[i] !== this.options.classes[i] && n && n.length && (s = t(n.get()), this._removeClass(n, i), s.addClass(this._classes({
          element: s,
          keys: i,
          classes: e,
          add: !0
        })));
      }
    },
    _setOptionDisabled: function _setOptionDisabled(t) {
      this._toggleClass(this.widget(), this.widgetFullName + "-disabled", null, !!t), t && (this._removeClass(this.hoverable, null, "ui-state-hover"), this._removeClass(this.focusable, null, "ui-state-focus"));
    },
    enable: function enable() {
      return this._setOptions({
        disabled: !1
      });
    },
    disable: function disable() {
      return this._setOptions({
        disabled: !0
      });
    },
    _classes: function _classes(e) {
      function i(i, o) {
        var a, r;

        for (r = 0; i.length > r; r++) {
          a = n.classesElementLookup[i[r]] || t(), a = e.add ? t(t.unique(a.get().concat(e.element.get()))) : t(a.not(e.element).get()), n.classesElementLookup[i[r]] = a, s.push(i[r]), o && e.classes[i[r]] && s.push(e.classes[i[r]]);
        }
      }

      var s = [],
          n = this;
      return e = t.extend({
        element: this.element,
        classes: this.options.classes || {}
      }, e), this._on(e.element, {
        remove: "_untrackClassesElement"
      }), e.keys && i(e.keys.match(/\S+/g) || [], !0), e.extra && i(e.extra.match(/\S+/g) || []), s.join(" ");
    },
    _untrackClassesElement: function _untrackClassesElement(e) {
      var i = this;
      t.each(i.classesElementLookup, function (s, n) {
        -1 !== t.inArray(e.target, n) && (i.classesElementLookup[s] = t(n.not(e.target).get()));
      });
    },
    _removeClass: function _removeClass(t, e, i) {
      return this._toggleClass(t, e, i, !1);
    },
    _addClass: function _addClass(t, e, i) {
      return this._toggleClass(t, e, i, !0);
    },
    _toggleClass: function _toggleClass(t, e, i, s) {
      s = "boolean" == typeof s ? s : i;
      var n = "string" == typeof t || null === t,
          o = {
        extra: n ? e : i,
        keys: n ? t : e,
        element: n ? this.element : t,
        add: s
      };
      return o.element.toggleClass(this._classes(o), s), this;
    },
    _on: function _on(e, i, s) {
      var n,
          o = this;
      "boolean" != typeof e && (s = i, i = e, e = !1), s ? (i = n = t(i), this.bindings = this.bindings.add(i)) : (s = i, i = this.element, n = this.widget()), t.each(s, function (s, a) {
        function r() {
          return e || o.options.disabled !== !0 && !t(this).hasClass("ui-state-disabled") ? ("string" == typeof a ? o[a] : a).apply(o, arguments) : void 0;
        }

        "string" != typeof a && (r.guid = a.guid = a.guid || r.guid || t.guid++);
        var l = s.match(/^([\w:-]*)\s*(.*)$/),
            h = l[1] + o.eventNamespace,
            c = l[2];
        c ? n.on(h, c, r) : i.on(h, r);
      });
    },
    _off: function _off(e, i) {
      i = (i || "").split(" ").join(this.eventNamespace + " ") + this.eventNamespace, e.off(i).off(i), this.bindings = t(this.bindings.not(e).get()), this.focusable = t(this.focusable.not(e).get()), this.hoverable = t(this.hoverable.not(e).get());
    },
    _delay: function _delay(t, e) {
      function i() {
        return ("string" == typeof t ? s[t] : t).apply(s, arguments);
      }

      var s = this;
      return setTimeout(i, e || 0);
    },
    _hoverable: function _hoverable(e) {
      this.hoverable = this.hoverable.add(e), this._on(e, {
        mouseenter: function mouseenter(e) {
          this._addClass(t(e.currentTarget), null, "ui-state-hover");
        },
        mouseleave: function mouseleave(e) {
          this._removeClass(t(e.currentTarget), null, "ui-state-hover");
        }
      });
    },
    _focusable: function _focusable(e) {
      this.focusable = this.focusable.add(e), this._on(e, {
        focusin: function focusin(e) {
          this._addClass(t(e.currentTarget), null, "ui-state-focus");
        },
        focusout: function focusout(e) {
          this._removeClass(t(e.currentTarget), null, "ui-state-focus");
        }
      });
    },
    _trigger: function _trigger(e, i, s) {
      var n,
          o,
          a = this.options[e];
      if (s = s || {}, i = t.Event(i), i.type = (e === this.widgetEventPrefix ? e : this.widgetEventPrefix + e).toLowerCase(), i.target = this.element[0], o = i.originalEvent) for (n in o) {
        n in i || (i[n] = o[n]);
      }
      return this.element.trigger(i, s), !(t.isFunction(a) && a.apply(this.element[0], [i].concat(s)) === !1 || i.isDefaultPrevented());
    }
  }, t.each({
    show: "fadeIn",
    hide: "fadeOut"
  }, function (e, i) {
    t.Widget.prototype["_" + e] = function (s, n, o) {
      "string" == typeof n && (n = {
        effect: n
      });
      var a,
          r = n ? n === !0 || "number" == typeof n ? i : n.effect || i : e;
      n = n || {}, "number" == typeof n && (n = {
        duration: n
      }), a = !t.isEmptyObject(n), n.complete = o, n.delay && s.delay(n.delay), a && t.effects && t.effects.effect[r] ? s[e](n) : r !== e && s[r] ? s[r](n.duration, n.easing, o) : s.queue(function (i) {
        t(this)[e](), o && o.call(s[0]), i();
      });
    };
  }), t.widget, t.ui.keyCode = {
    BACKSPACE: 8,
    COMMA: 188,
    DELETE: 46,
    DOWN: 40,
    END: 35,
    ENTER: 13,
    ESCAPE: 27,
    HOME: 36,
    LEFT: 37,
    PAGE_DOWN: 34,
    PAGE_UP: 33,
    PERIOD: 190,
    RIGHT: 39,
    SPACE: 32,
    TAB: 9,
    UP: 38
  }, t.ui.ie = !!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());
  var s = !1;
  t(document).on("mouseup", function () {
    s = !1;
  }), t.widget("ui.mouse", {
    version: "1.12.1",
    options: {
      cancel: "input, textarea, button, select, option",
      distance: 1,
      delay: 0
    },
    _mouseInit: function _mouseInit() {
      var e = this;
      this.element.on("mousedown." + this.widgetName, function (t) {
        return e._mouseDown(t);
      }).on("click." + this.widgetName, function (i) {
        return !0 === t.data(i.target, e.widgetName + ".preventClickEvent") ? (t.removeData(i.target, e.widgetName + ".preventClickEvent"), i.stopImmediatePropagation(), !1) : void 0;
      }), this.started = !1;
    },
    _mouseDestroy: function _mouseDestroy() {
      this.element.off("." + this.widgetName), this._mouseMoveDelegate && this.document.off("mousemove." + this.widgetName, this._mouseMoveDelegate).off("mouseup." + this.widgetName, this._mouseUpDelegate);
    },
    _mouseDown: function _mouseDown(e) {
      if (!s) {
        this._mouseMoved = !1, this._mouseStarted && this._mouseUp(e), this._mouseDownEvent = e;
        var i = this,
            n = 1 === e.which,
            o = "string" == typeof this.options.cancel && e.target.nodeName ? t(e.target).closest(this.options.cancel).length : !1;
        return n && !o && this._mouseCapture(e) ? (this.mouseDelayMet = !this.options.delay, this.mouseDelayMet || (this._mouseDelayTimer = setTimeout(function () {
          i.mouseDelayMet = !0;
        }, this.options.delay)), this._mouseDistanceMet(e) && this._mouseDelayMet(e) && (this._mouseStarted = this._mouseStart(e) !== !1, !this._mouseStarted) ? (e.preventDefault(), !0) : (!0 === t.data(e.target, this.widgetName + ".preventClickEvent") && t.removeData(e.target, this.widgetName + ".preventClickEvent"), this._mouseMoveDelegate = function (t) {
          return i._mouseMove(t);
        }, this._mouseUpDelegate = function (t) {
          return i._mouseUp(t);
        }, this.document.on("mousemove." + this.widgetName, this._mouseMoveDelegate).on("mouseup." + this.widgetName, this._mouseUpDelegate), e.preventDefault(), s = !0, !0)) : !0;
      }
    },
    _mouseMove: function _mouseMove(e) {
      if (this._mouseMoved) {
        if (t.ui.ie && (!document.documentMode || 9 > document.documentMode) && !e.button) return this._mouseUp(e);
        if (!e.which) if (e.originalEvent.altKey || e.originalEvent.ctrlKey || e.originalEvent.metaKey || e.originalEvent.shiftKey) this.ignoreMissingWhich = !0;else if (!this.ignoreMissingWhich) return this._mouseUp(e);
      }

      return (e.which || e.button) && (this._mouseMoved = !0), this._mouseStarted ? (this._mouseDrag(e), e.preventDefault()) : (this._mouseDistanceMet(e) && this._mouseDelayMet(e) && (this._mouseStarted = this._mouseStart(this._mouseDownEvent, e) !== !1, this._mouseStarted ? this._mouseDrag(e) : this._mouseUp(e)), !this._mouseStarted);
    },
    _mouseUp: function _mouseUp(e) {
      this.document.off("mousemove." + this.widgetName, this._mouseMoveDelegate).off("mouseup." + this.widgetName, this._mouseUpDelegate), this._mouseStarted && (this._mouseStarted = !1, e.target === this._mouseDownEvent.target && t.data(e.target, this.widgetName + ".preventClickEvent", !0), this._mouseStop(e)), this._mouseDelayTimer && (clearTimeout(this._mouseDelayTimer), delete this._mouseDelayTimer), this.ignoreMissingWhich = !1, s = !1, e.preventDefault();
    },
    _mouseDistanceMet: function _mouseDistanceMet(t) {
      return Math.max(Math.abs(this._mouseDownEvent.pageX - t.pageX), Math.abs(this._mouseDownEvent.pageY - t.pageY)) >= this.options.distance;
    },
    _mouseDelayMet: function _mouseDelayMet() {
      return this.mouseDelayMet;
    },
    _mouseStart: function _mouseStart() {},
    _mouseDrag: function _mouseDrag() {},
    _mouseStop: function _mouseStop() {},
    _mouseCapture: function _mouseCapture() {
      return !0;
    }
  }), t.widget("ui.slider", t.ui.mouse, {
    version: "1.12.1",
    widgetEventPrefix: "slide",
    options: {
      animate: !1,
      classes: {
        "ui-slider": "ui-corner-all",
        "ui-slider-handle": "ui-corner-all",
        "ui-slider-range": "ui-corner-all ui-widget-header"
      },
      distance: 0,
      max: 100,
      min: 0,
      orientation: "horizontal",
      range: !1,
      step: 1,
      value: 0,
      values: null,
      change: null,
      slide: null,
      start: null,
      stop: null
    },
    numPages: 5,
    _create: function _create() {
      this._keySliding = !1, this._mouseSliding = !1, this._animateOff = !0, this._handleIndex = null, this._detectOrientation(), this._mouseInit(), this._calculateNewMax(), this._addClass("ui-slider ui-slider-" + this.orientation, "ui-widget ui-widget-content"), this._refresh(), this._animateOff = !1;
    },
    _refresh: function _refresh() {
      this._createRange(), this._createHandles(), this._setupEvents(), this._refreshValue();
    },
    _createHandles: function _createHandles() {
      var e,
          i,
          s = this.options,
          n = this.element.find(".ui-slider-handle"),
          o = "<span tabindex='0'></span>",
          a = [];

      for (i = s.values && s.values.length || 1, n.length > i && (n.slice(i).remove(), n = n.slice(0, i)), e = n.length; i > e; e++) {
        a.push(o);
      }

      this.handles = n.add(t(a.join("")).appendTo(this.element)), this._addClass(this.handles, "ui-slider-handle", "ui-state-default"), this.handle = this.handles.eq(0), this.handles.each(function (e) {
        t(this).data("ui-slider-handle-index", e).attr("tabIndex", 0);
      });
    },
    _createRange: function _createRange() {
      var e = this.options;
      e.range ? (e.range === !0 && (e.values ? e.values.length && 2 !== e.values.length ? e.values = [e.values[0], e.values[0]] : t.isArray(e.values) && (e.values = e.values.slice(0)) : e.values = [this._valueMin(), this._valueMin()]), this.range && this.range.length ? (this._removeClass(this.range, "ui-slider-range-min ui-slider-range-max"), this.range.css({
        left: "",
        bottom: ""
      })) : (this.range = t("<div>").appendTo(this.element), this._addClass(this.range, "ui-slider-range")), ("min" === e.range || "max" === e.range) && this._addClass(this.range, "ui-slider-range-" + e.range)) : (this.range && this.range.remove(), this.range = null);
    },
    _setupEvents: function _setupEvents() {
      this._off(this.handles), this._on(this.handles, this._handleEvents), this._hoverable(this.handles), this._focusable(this.handles);
    },
    _destroy: function _destroy() {
      this.handles.remove(), this.range && this.range.remove(), this._mouseDestroy();
    },
    _mouseCapture: function _mouseCapture(e) {
      var i,
          s,
          n,
          o,
          a,
          r,
          l,
          h,
          c = this,
          u = this.options;
      return u.disabled ? !1 : (this.elementSize = {
        width: this.element.outerWidth(),
        height: this.element.outerHeight()
      }, this.elementOffset = this.element.offset(), i = {
        x: e.pageX,
        y: e.pageY
      }, s = this._normValueFromMouse(i), n = this._valueMax() - this._valueMin() + 1, this.handles.each(function (e) {
        var i = Math.abs(s - c.values(e));
        (n > i || n === i && (e === c._lastChangedValue || c.values(e) === u.min)) && (n = i, o = t(this), a = e);
      }), r = this._start(e, a), r === !1 ? !1 : (this._mouseSliding = !0, this._handleIndex = a, this._addClass(o, null, "ui-state-active"), o.trigger("focus"), l = o.offset(), h = !t(e.target).parents().addBack().is(".ui-slider-handle"), this._clickOffset = h ? {
        left: 0,
        top: 0
      } : {
        left: e.pageX - l.left - o.width() / 2,
        top: e.pageY - l.top - o.height() / 2 - (parseInt(o.css("borderTopWidth"), 10) || 0) - (parseInt(o.css("borderBottomWidth"), 10) || 0) + (parseInt(o.css("marginTop"), 10) || 0)
      }, this.handles.hasClass("ui-state-hover") || this._slide(e, a, s), this._animateOff = !0, !0));
    },
    _mouseStart: function _mouseStart() {
      return !0;
    },
    _mouseDrag: function _mouseDrag(t) {
      var e = {
        x: t.pageX,
        y: t.pageY
      },
          i = this._normValueFromMouse(e);

      return this._slide(t, this._handleIndex, i), !1;
    },
    _mouseStop: function _mouseStop(t) {
      return this._removeClass(this.handles, null, "ui-state-active"), this._mouseSliding = !1, this._stop(t, this._handleIndex), this._change(t, this._handleIndex), this._handleIndex = null, this._clickOffset = null, this._animateOff = !1, !1;
    },
    _detectOrientation: function _detectOrientation() {
      this.orientation = "vertical" === this.options.orientation ? "vertical" : "horizontal";
    },
    _normValueFromMouse: function _normValueFromMouse(t) {
      var e, i, s, n, o;
      return "horizontal" === this.orientation ? (e = this.elementSize.width, i = t.x - this.elementOffset.left - (this._clickOffset ? this._clickOffset.left : 0)) : (e = this.elementSize.height, i = t.y - this.elementOffset.top - (this._clickOffset ? this._clickOffset.top : 0)), s = i / e, s > 1 && (s = 1), 0 > s && (s = 0), "vertical" === this.orientation && (s = 1 - s), n = this._valueMax() - this._valueMin(), o = this._valueMin() + s * n, this._trimAlignValue(o);
    },
    _uiHash: function _uiHash(t, e, i) {
      var s = {
        handle: this.handles[t],
        handleIndex: t,
        value: void 0 !== e ? e : this.value()
      };
      return this._hasMultipleValues() && (s.value = void 0 !== e ? e : this.values(t), s.values = i || this.values()), s;
    },
    _hasMultipleValues: function _hasMultipleValues() {
      return this.options.values && this.options.values.length;
    },
    _start: function _start(t, e) {
      return this._trigger("start", t, this._uiHash(e));
    },
    _slide: function _slide(t, e, i) {
      var s,
          n,
          o = this.value(),
          a = this.values();
      this._hasMultipleValues() && (n = this.values(e ? 0 : 1), o = this.values(e), 2 === this.options.values.length && this.options.range === !0 && (i = 0 === e ? Math.min(n, i) : Math.max(n, i)), a[e] = i), i !== o && (s = this._trigger("slide", t, this._uiHash(e, i, a)), s !== !1 && (this._hasMultipleValues() ? this.values(e, i) : this.value(i)));
    },
    _stop: function _stop(t, e) {
      this._trigger("stop", t, this._uiHash(e));
    },
    _change: function _change(t, e) {
      this._keySliding || this._mouseSliding || (this._lastChangedValue = e, this._trigger("change", t, this._uiHash(e)));
    },
    value: function value(t) {
      return arguments.length ? (this.options.value = this._trimAlignValue(t), this._refreshValue(), this._change(null, 0), void 0) : this._value();
    },
    values: function values(e, i) {
      var s, n, o;
      if (arguments.length > 1) return this.options.values[e] = this._trimAlignValue(i), this._refreshValue(), this._change(null, e), void 0;
      if (!arguments.length) return this._values();
      if (!t.isArray(arguments[0])) return this._hasMultipleValues() ? this._values(e) : this.value();

      for (s = this.options.values, n = arguments[0], o = 0; s.length > o; o += 1) {
        s[o] = this._trimAlignValue(n[o]), this._change(null, o);
      }

      this._refreshValue();
    },
    _setOption: function _setOption(e, i) {
      var s,
          n = 0;

      switch ("range" === e && this.options.range === !0 && ("min" === i ? (this.options.value = this._values(0), this.options.values = null) : "max" === i && (this.options.value = this._values(this.options.values.length - 1), this.options.values = null)), t.isArray(this.options.values) && (n = this.options.values.length), this._super(e, i), e) {
        case "orientation":
          this._detectOrientation(), this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-" + this.orientation), this._refreshValue(), this.options.range && this._refreshRange(i), this.handles.css("horizontal" === i ? "bottom" : "left", "");
          break;

        case "value":
          this._animateOff = !0, this._refreshValue(), this._change(null, 0), this._animateOff = !1;
          break;

        case "values":
          for (this._animateOff = !0, this._refreshValue(), s = n - 1; s >= 0; s--) {
            this._change(null, s);
          }

          this._animateOff = !1;
          break;

        case "step":
        case "min":
        case "max":
          this._animateOff = !0, this._calculateNewMax(), this._refreshValue(), this._animateOff = !1;
          break;

        case "range":
          this._animateOff = !0, this._refresh(), this._animateOff = !1;
      }
    },
    _setOptionDisabled: function _setOptionDisabled(t) {
      this._super(t), this._toggleClass(null, "ui-state-disabled", !!t);
    },
    _value: function _value() {
      var t = this.options.value;
      return t = this._trimAlignValue(t);
    },
    _values: function _values(t) {
      var e, i, s;
      if (arguments.length) return e = this.options.values[t], e = this._trimAlignValue(e);

      if (this._hasMultipleValues()) {
        for (i = this.options.values.slice(), s = 0; i.length > s; s += 1) {
          i[s] = this._trimAlignValue(i[s]);
        }

        return i;
      }

      return [];
    },
    _trimAlignValue: function _trimAlignValue(t) {
      if (this._valueMin() >= t) return this._valueMin();
      if (t >= this._valueMax()) return this._valueMax();
      var e = this.options.step > 0 ? this.options.step : 1,
          i = (t - this._valueMin()) % e,
          s = t - i;
      return 2 * Math.abs(i) >= e && (s += i > 0 ? e : -e), parseFloat(s.toFixed(5));
    },
    _calculateNewMax: function _calculateNewMax() {
      var t = this.options.max,
          e = this._valueMin(),
          i = this.options.step,
          s = Math.round((t - e) / i) * i;

      t = s + e, t > this.options.max && (t -= i), this.max = parseFloat(t.toFixed(this._precision()));
    },
    _precision: function _precision() {
      var t = this._precisionOf(this.options.step);

      return null !== this.options.min && (t = Math.max(t, this._precisionOf(this.options.min))), t;
    },
    _precisionOf: function _precisionOf(t) {
      var e = "" + t,
          i = e.indexOf(".");
      return -1 === i ? 0 : e.length - i - 1;
    },
    _valueMin: function _valueMin() {
      return this.options.min;
    },
    _valueMax: function _valueMax() {
      return this.max;
    },
    _refreshRange: function _refreshRange(t) {
      "vertical" === t && this.range.css({
        width: "",
        left: ""
      }), "horizontal" === t && this.range.css({
        height: "",
        bottom: ""
      });
    },
    _refreshValue: function _refreshValue() {
      var e,
          i,
          s,
          n,
          o,
          a = this.options.range,
          r = this.options,
          l = this,
          h = this._animateOff ? !1 : r.animate,
          c = {};
      this._hasMultipleValues() ? this.handles.each(function (s) {
        i = 100 * ((l.values(s) - l._valueMin()) / (l._valueMax() - l._valueMin())), c["horizontal" === l.orientation ? "left" : "bottom"] = i + "%", t(this).stop(1, 1)[h ? "animate" : "css"](c, r.animate), l.options.range === !0 && ("horizontal" === l.orientation ? (0 === s && l.range.stop(1, 1)[h ? "animate" : "css"]({
          left: i + "%"
        }, r.animate), 1 === s && l.range[h ? "animate" : "css"]({
          width: i - e + "%"
        }, {
          queue: !1,
          duration: r.animate
        })) : (0 === s && l.range.stop(1, 1)[h ? "animate" : "css"]({
          bottom: i + "%"
        }, r.animate), 1 === s && l.range[h ? "animate" : "css"]({
          height: i - e + "%"
        }, {
          queue: !1,
          duration: r.animate
        }))), e = i;
      }) : (s = this.value(), n = this._valueMin(), o = this._valueMax(), i = o !== n ? 100 * ((s - n) / (o - n)) : 0, c["horizontal" === this.orientation ? "left" : "bottom"] = i + "%", this.handle.stop(1, 1)[h ? "animate" : "css"](c, r.animate), "min" === a && "horizontal" === this.orientation && this.range.stop(1, 1)[h ? "animate" : "css"]({
        width: i + "%"
      }, r.animate), "max" === a && "horizontal" === this.orientation && this.range.stop(1, 1)[h ? "animate" : "css"]({
        width: 100 - i + "%"
      }, r.animate), "min" === a && "vertical" === this.orientation && this.range.stop(1, 1)[h ? "animate" : "css"]({
        height: i + "%"
      }, r.animate), "max" === a && "vertical" === this.orientation && this.range.stop(1, 1)[h ? "animate" : "css"]({
        height: 100 - i + "%"
      }, r.animate));
    },
    _handleEvents: {
      keydown: function keydown(e) {
        var i,
            s,
            n,
            o,
            a = t(e.target).data("ui-slider-handle-index");

        switch (e.keyCode) {
          case t.ui.keyCode.HOME:
          case t.ui.keyCode.END:
          case t.ui.keyCode.PAGE_UP:
          case t.ui.keyCode.PAGE_DOWN:
          case t.ui.keyCode.UP:
          case t.ui.keyCode.RIGHT:
          case t.ui.keyCode.DOWN:
          case t.ui.keyCode.LEFT:
            if (e.preventDefault(), !this._keySliding && (this._keySliding = !0, this._addClass(t(e.target), null, "ui-state-active"), i = this._start(e, a), i === !1)) return;
        }

        switch (o = this.options.step, s = n = this._hasMultipleValues() ? this.values(a) : this.value(), e.keyCode) {
          case t.ui.keyCode.HOME:
            n = this._valueMin();
            break;

          case t.ui.keyCode.END:
            n = this._valueMax();
            break;

          case t.ui.keyCode.PAGE_UP:
            n = this._trimAlignValue(s + (this._valueMax() - this._valueMin()) / this.numPages);
            break;

          case t.ui.keyCode.PAGE_DOWN:
            n = this._trimAlignValue(s - (this._valueMax() - this._valueMin()) / this.numPages);
            break;

          case t.ui.keyCode.UP:
          case t.ui.keyCode.RIGHT:
            if (s === this._valueMax()) return;
            n = this._trimAlignValue(s + o);
            break;

          case t.ui.keyCode.DOWN:
          case t.ui.keyCode.LEFT:
            if (s === this._valueMin()) return;
            n = this._trimAlignValue(s - o);
        }

        this._slide(e, a, n);
      },
      keyup: function keyup(e) {
        var i = t(e.target).data("ui-slider-handle-index");
        this._keySliding && (this._keySliding = !1, this._stop(e, i), this._change(e, i), this._removeClass(t(e.target), null, "ui-state-active"));
      }
    }
  });
});
/*!
 * jQuery UI Touch Punch 0.2.3
 *
 * Copyright 2011вЂ“2014, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 */


!function (a) {
  function f(a, b) {
    if (!(a.originalEvent.touches.length > 1)) {
      a.preventDefault();
      var c = a.originalEvent.changedTouches[0],
          d = document.createEvent("MouseEvents");
      d.initMouseEvent(b, !0, !0, window, 1, c.screenX, c.screenY, c.clientX, c.clientY, !1, !1, !1, !1, 0, null), a.target.dispatchEvent(d);
    }
  }

  if (a.support.touch = "ontouchend" in document, a.support.touch) {
    var e,
        b = a.ui.mouse.prototype,
        c = b._mouseInit,
        d = b._mouseDestroy;
    b._touchStart = function (a) {
      var b = this;
      !e && b._mouseCapture(a.originalEvent.changedTouches[0]) && (e = !0, b._touchMoved = !1, f(a, "mouseover"), f(a, "mousemove"), f(a, "mousedown"));
    }, b._touchMove = function (a) {
      e && (this._touchMoved = !0, f(a, "mousemove"));
    }, b._touchEnd = function (a) {
      e && (f(a, "mouseup"), f(a, "mouseout"), this._touchMoved || f(a, "click"), e = !1);
    }, b._mouseInit = function () {
      var b = this;
      b.element.bind({
        touchstart: a.proxy(b, "_touchStart"),
        touchmove: a.proxy(b, "_touchMove"),
        touchend: a.proxy(b, "_touchEnd")
      }), c.call(b);
    }, b._mouseDestroy = function () {
      var b = this;
      b.element.unbind({
        touchstart: a.proxy(b, "_touchStart"),
        touchmove: a.proxy(b, "_touchMove"),
        touchend: a.proxy(b, "_touchEnd")
      }), d.call(b);
    };
  }
}(jQuery);
window.jdata = window.jdata || {};
window.jdata.countries = {
  "GD": ["Grenada"],
  "GE": ["Georgia"],
  "GF": ["French Guiana"],
  "GA": ["Gabon"],
  "GB": ["the United Kingdom", "UK"],
  "FK": ["Falkland Islands (Malvinas)"],
  "FJ": ["Fiji"],
  "FM": ["Micronesia"],
  "FI": ["Finland"],
  "FR": ["France"],
  "FO": ["Faroe Islands"],
  "GY": ["Guyana"],
  "GW": ["Guinea-Bissau"],
  "WS": ["Samoa"],
  "GN": ["Guinea"],
  "GM": ["Gambia"],
  "GL": ["Greenland"],
  "GI": ["Gibraltar"],
  "GH": ["Ghana"],
  "GG": ["Guernsey"],
  "GU": ["Guam"],
  "GT": ["Guatemala"],
  "GS": ["South Georgia and the South Sandwich Islands"],
  "GR": ["Greece"],
  "GQ": ["Equatorial Guinea"],
  "WF": ["Wallis and Futuna"],
  "GP": ["Guadeloupe"],
  "VI": ["Virgin Islands"],
  "DZ": ["Algeria"],
  "VG": ["Virgin Islands"],
  "VU": ["Vanuatu"],
  "VN": ["Vietnam"],
  "EC": ["Ecuador"],
  "DE": ["Germany"],
  "UZ": ["Uzbekistan"],
  "UY": ["Uruguay"],
  "DK": ["Denmark"],
  "DJ": ["Djibouti"],
  "VE": ["Venezuela"],
  "DM": ["Dominica"],
  "VC": ["Saint Vincent and the Grenadines"],
  "DO": ["Dominican Republic"],
  "VA": ["Holy See (Vatican City State)"],
  "EU": ["Europe"],
  "UG": ["Uganda"],
  "US": ["the USA", "North America"],
  "UM": ["United States Minor Outlying Islands"],
  "EH": ["Western Sahara"],
  "EG": ["Egypt"],
  "TZ": ["Tanzania"],
  "EE": ["Estonia"],
  "TT": ["Trinidad and Tobago"],
  "TW": ["Taiwan"],
  "TV": ["Tuvalu"],
  "UA": ["Ukraine"],
  "ET": ["Ethiopia"],
  "ES": ["Spain"],
  "ER": ["Eritrea"],
  "TO": ["Tonga"],
  "TN": ["Tunisia"],
  "TM": ["Turkmenistan"],
  "TL": ["Timor-Leste"],
  "CA": ["Canada"],
  "TR": ["Turkey"],
  "BZ": ["Belize"],
  "TG": ["Togo"],
  "BW": ["Botswana"],
  "TF": ["French Southern Territories"],
  "BV": ["Bouvet Island"],
  "BY": ["Belarus"],
  "TD": ["Chad"],
  "TK": ["Tokelau"],
  "BS": ["Bahamas"],
  "TJ": ["Tajikistan"],
  "BR": ["Brazil"],
  "TH": ["Thailand"],
  "BT": ["Bhutan"],
  "BN": ["Brunei Darussalam"],
  "BO": ["Bolivia"],
  "BQ": ["Bonaire"],
  "BJ": ["Benin"],
  "TC": ["Turks and Caicos Islands"],
  "BL": ["Saint Bartelemey"],
  "BM": ["Bermuda"],
  "BF": ["Burkina Faso"],
  "SV": ["El Salvador"],
  "BG": ["Bulgaria"],
  "SS": ["South Sudan"],
  "BH": ["Bahrain"],
  "ST": ["Sao Tome and Principe"],
  "BI": ["Burundi"],
  "SY": ["Syrian Arab Republic"],
  "BB": ["Barbados"],
  "SZ": ["Swaziland"],
  "BD": ["Bangladesh"],
  "SX": ["Sint Maarten"],
  "BE": ["Belgium"],
  "SL": ["Sierra Leone"],
  "SK": ["Slovakia"],
  "SN": ["Senegal"],
  "SM": ["San Marino"],
  "SO": ["Somalia"],
  "SR": ["Suriname"],
  "SD": ["Sudan"],
  "CZ": ["Czech Republic"],
  "SC": ["Seychelles"],
  "CY": ["Cyprus"],
  "CX": ["Christmas Island"],
  "SE": ["Sweden"],
  "CW": ["Curacao"],
  "SH": ["Saint Helena"],
  "CV": ["Cape Verde"],
  "SG": ["Singapore"],
  "CU": ["Cuba"],
  "SJ": ["Svalbard and Jan Mayen"],
  "SI": ["Slovenia"],
  "CR": ["Costa Rica"],
  "CO": ["Colombia"],
  "CM": ["Cameroon"],
  "CN": ["China"],
  "SA": ["Saudi Arabia"],
  "CK": ["Cook Islands"],
  "SB": ["Solomon Islands"],
  "CL": ["Chile"],
  "CI": ["Cote d'Ivoire"],
  "RS": ["Serbia"],
  "CG": ["Congo"],
  "RU": ["Russian Federation"],
  "CH": ["Switzerland"],
  "RW": ["Rwanda"],
  "CF": ["Central African Republic"],
  "CC": ["Cocos (Keeling) Islands"],
  "CD": ["Congo"],
  "RO": ["Romania"],
  "RE": ["Reunion"],
  "AZ": ["Azerbaijan"],
  "BA": ["Bosnia and Herzegovina"],
  "AT": ["Austria"],
  "AS": ["American Samoa"],
  "AR": ["Argentina"],
  "AQ": ["Antarctica"],
  "AX": ["Aland Islands"],
  "AW": ["Aruba"],
  "QA": ["Qatar"],
  "AU": ["Australia"],
  "AL": ["Albania"],
  "AI": ["Anguilla"],
  "AO": ["Angola"],
  "AP": ["Asia/Pacific Region"],
  "PY": ["Paraguay"],
  "AM": ["Armenia"],
  "PT": ["Portugal"],
  "AD": ["Andorra"],
  "PW": ["Palau"],
  "AG": ["Antigua and Barbuda"],
  "AE": ["United Arab Emirates"],
  "PR": ["Puerto Rico"],
  "AF": ["Afghanistan"],
  "PS": ["Palestinian Territory"],
  "NU": ["Niue"],
  "NR": ["Nauru"],
  "NP": ["Nepal"],
  "NO": ["Norway"],
  "NZ": ["New Zealand"],
  "OM": ["Oman"],
  "PE": ["Peru"],
  "PF": ["French Polynesia"],
  "PG": ["Papua New Guinea"],
  "PA": ["Panama"],
  "PL": ["Poland"],
  "PM": ["Saint Pierre and Miquelon"],
  "PN": ["Pitcairn"],
  "PH": ["Philippines"],
  "PK": ["Pakistan"],
  "LS": ["Lesotho"],
  "LR": ["Liberia"],
  "LV": ["Latvia"],
  "LU": ["Luxembourg"],
  "LT": ["Lithuania"],
  "LY": ["Libyan Arab Jamahiriya"],
  "MC": ["Monaco"],
  "MD": ["Moldova"],
  "MA": ["Morocco"],
  "A1": ["Anonymous Proxy"],
  "MG": ["Madagascar"],
  "A2": ["Satellite Provider"],
  "MH": ["Marshall Islands"],
  "ME": ["Montenegro"],
  "MF": ["Saint Martin"],
  "MK": ["Macedonia"],
  "ML": ["Mali"],
  "MN": ["Mongolia"],
  "MM": ["Myanmar"],
  "MP": ["Northern Mariana Islands"],
  "O1": ["Other Country"],
  "MO": ["Macao"],
  "MR": ["Mauritania"],
  "MQ": ["Martinique"],
  "MT": ["Malta"],
  "MS": ["Montserrat"],
  "MV": ["Maldives"],
  "MU": ["Mauritius"],
  "MX": ["Mexico"],
  "MW": ["Malawi"],
  "MZ": ["Mozambique"],
  "MY": ["Malaysia"],
  "NA": ["Namibia"],
  "NC": ["New Caledonia"],
  "NE": ["Niger"],
  "NF": ["Norfolk Island"],
  "NG": ["Nigeria"],
  "NI": ["Nicaragua"],
  "NL": ["the Netherlands", "Holland"],
  "JP": ["Japan"],
  "JO": ["Jordan"],
  "JM": ["Jamaica"],
  "KI": ["Kiribati"],
  "KH": ["Cambodia"],
  "KG": ["Kyrgyzstan"],
  "KE": ["Kenya"],
  "KW": ["Kuwait"],
  "KY": ["Cayman Islands"],
  "KZ": ["Kazakhstan"],
  "KP": ["Korea"],
  "KR": ["Korea"],
  "KM": ["Comoros"],
  "KN": ["Saint Kitts and Nevis"],
  "LI": ["Liechtenstein"],
  "LK": ["Sri Lanka"],
  "LA": ["Lao People's Democratic Republic"],
  "LC": ["Saint Lucia"],
  "LB": ["Lebanon"],
  "HR": ["Croatia"],
  "HT": ["Haiti"],
  "HU": ["Hungary"],
  "HK": ["Hong Kong"],
  "ZA": ["South Africa"],
  "HN": ["Honduras"],
  "HM": ["Heard Island and McDonald Islands"],
  "ZW": ["Zimbabwe"],
  "ID": ["Indonesia"],
  "IE": ["Ireland"],
  "ZM": ["Zambia"],
  "IQ": ["Iraq"],
  "IR": ["Iran"],
  "YE": ["Yemen"],
  "IS": ["Iceland"],
  "IT": ["Italy"],
  "IL": ["Israel"],
  "IM": ["Isle of Man"],
  "IN": ["India"],
  "IO": ["British Indian Ocean Territory"],
  "JE": ["Jersey"],
  "YT": ["Mayotte"]
};
window.jdata = window.jdata || {};
window.jdata.countryContinent = {
  "AD": "EU",
  "AE": "AS",
  "AF": "AS",
  "AG": "LA",
  "AI": "LA",
  "AL": "EU",
  "AM": "AS",
  "AN": "LA",
  "AO": "AF",
  "AQ": "AN",
  "AR": "LA",
  "AS": "OC",
  "AT": "EU",
  "AU": "OC",
  "AW": "LA",
  "AX": "EU",
  "AZ": "AS",
  "BA": "EU",
  "BB": "LA",
  "BD": "AS",
  "BE": "EU",
  "BF": "AF",
  "BG": "EU",
  "BH": "AS",
  "BI": "AF",
  "BJ": "AF",
  "BL": "LA",
  "BM": "LA",
  "BN": "AS",
  "BO": "LA",
  "BQ": "LA",
  "BR": "LA",
  "BS": "LA",
  "BT": "AS",
  "BV": "AN",
  "BW": "AF",
  "BY": "EU",
  "BZ": "LA",
  "CA": "NA",
  "CC": "AS",
  "CD": "AF",
  "CF": "AF",
  "CG": "AF",
  "CH": "EU",
  "CI": "AF",
  "CK": "OC",
  "CL": "LA",
  "CM": "AF",
  "CN": "AS",
  "CO": "LA",
  "CR": "LA",
  "CS": "EU",
  "CU": "LA",
  "CV": "AF",
  "CW": "LA",
  "CX": "AS",
  "CY": "EU",
  "CZ": "EU",
  "DE": "EU",
  "DJ": "AF",
  "DK": "EU",
  "DM": "LA",
  "DO": "LA",
  "DZ": "AF",
  "EC": "LA",
  "EE": "EU",
  "EG": "AF",
  "EH": "AF",
  "ER": "AF",
  "ES": "EU",
  "ET": "AF",
  "FI": "EU",
  "FJ": "OC",
  "FK": "LA",
  "FM": "OC",
  "FO": "EU",
  "FR": "EU",
  "GA": "AF",
  "GB": "EU",
  "GD": "LA",
  "GE": "AS",
  "GF": "LA",
  "GG": "EU",
  "GH": "AF",
  "GI": "EU",
  "GL": "LA",
  "GM": "AF",
  "GN": "AF",
  "GP": "LA",
  "GQ": "AF",
  "GR": "EU",
  "GS": "AN",
  "GT": "LA",
  "GU": "OC",
  "GW": "AF",
  "GY": "LA",
  "HK": "AS",
  "HM": "AN",
  "HN": "LA",
  "HR": "EU",
  "HT": "LA",
  "HU": "EU",
  "ID": "AS",
  "IE": "EU",
  "IL": "AS",
  "IM": "EU",
  "IN": "AS",
  "IO": "AS",
  "IQ": "AS",
  "IR": "AS",
  "IS": "EU",
  "IT": "EU",
  "JE": "EU",
  "JM": "LA",
  "JO": "AS",
  "JP": "AS",
  "KE": "AF",
  "KG": "AS",
  "KH": "AS",
  "KI": "OC",
  "KM": "AF",
  "KN": "LA",
  "KP": "AS",
  "KR": "AS",
  "KW": "AS",
  "KY": "LA",
  "KZ": "AS",
  "LA": "AS",
  "LB": "AS",
  "LC": "LA",
  "LI": "EU",
  "LK": "AS",
  "LR": "AF",
  "LS": "AF",
  "LT": "EU",
  "LU": "EU",
  "LV": "EU",
  "LY": "AF",
  "MA": "AF",
  "MC": "EU",
  "MD": "EU",
  "ME": "EU",
  "MF": "LA",
  "MG": "AF",
  "MH": "OC",
  "MK": "EU",
  "ML": "AF",
  "MM": "AS",
  "MN": "AS",
  "MO": "AS",
  "MP": "OC",
  "MQ": "LA",
  "MR": "AF",
  "MS": "LA",
  "MT": "EU",
  "MU": "AF",
  "MV": "AS",
  "MW": "AF",
  "MX": "LA",
  "MY": "AS",
  "MZ": "AF",
  "NA": "AF",
  "NC": "OC",
  "NE": "AF",
  "NF": "OC",
  "NG": "AF",
  "NI": "LA",
  "NL": "EU",
  "NO": "EU",
  "NP": "AS",
  "NR": "OC",
  "NU": "OC",
  "NZ": "OC",
  "OM": "AS",
  "PA": "LA",
  "PE": "LA",
  "PF": "OC",
  "PG": "OC",
  "PH": "AS",
  "PK": "AS",
  "PL": "EU",
  "PM": "LA",
  "PN": "OC",
  "PR": "LA",
  "PS": "AS",
  "PT": "EU",
  "PW": "OC",
  "PY": "LA",
  "QA": "AS",
  "RE": "AF",
  "RO": "EU",
  "RS": "EU",
  "RU": "EU",
  "RW": "AF",
  "SA": "AS",
  "SB": "OC",
  "SC": "AF",
  "SD": "AF",
  "SE": "EU",
  "SG": "AS",
  "SH": "AF",
  "SI": "EU",
  "SJ": "EU",
  "SK": "EU",
  "SL": "AF",
  "SM": "EU",
  "SN": "AF",
  "SO": "AF",
  "SR": "LA",
  "SS": "AF",
  "ST": "AF",
  "SV": "LA",
  "SX": "LA",
  "SY": "AS",
  "SZ": "AF",
  "TC": "LA",
  "TD": "AF",
  "TF": "AN",
  "TG": "AF",
  "TH": "AS",
  "TJ": "AS",
  "TK": "OC",
  "TL": "OC",
  "TM": "AS",
  "TN": "AF",
  "TO": "OC",
  "TR": "AS",
  "TT": "LA",
  "TV": "OC",
  "TW": "AS",
  "TZ": "AF",
  "UA": "EU",
  "UG": "AF",
  "UM": "OC",
  "US": "NA",
  "UY": "LA",
  "UZ": "AS",
  "VA": "EU",
  "VC": "LA",
  "VE": "LA",
  "VG": "LA",
  "VI": "LA",
  "VN": "AS",
  "VU": "OC",
  "WF": "OC",
  "WS": "OC",
  "XK": "EU",
  "YE": "AS",
  "YT": "AF",
  "ZA": "AF",
  "ZM": "AF",
  "ZW": "AF"
};
window.jdata.continent = {
  "EU": "Europe",
  "AS": "Asia",
  "NA": "North America",
  "LA": "Latin America",
  "OC": "Oceania",
  "AF": "Africa"
};
window.jdata.location = {
  "US": {
    "LA": "Los Angeles",
    "CH": "Chicago",
    "TX": "Texas",
    "GA": "Georgia",
    "NJ": "New Jersey",
    "NY": "New York",
    "NY1": "New York 1",
    "NY2": "New York 2"
  },
  "FI": {
    "HE": "Helsinki",
    "ES": "Espoo"
  },
  "CH": {
    "ATT": "Attinghausen",
    "ZU": "Zurich",
    "BN": "Bern",
    "GG": "Gland - Geneva",
    "GN1": "Geneva 1",
    "GN2": "Geneva 2"
  },
  "BR": {
    "CMP": "Campinas",
    "NOR": "Nordeste",
    "SP": "São Paulo"
  },
  "BE": {
    "NL": "datacenter in the Netherlands"
  },
  "IN": {
    "PU": "Pune"
  },
  "IL": {
    "RH": "Rosh Haayin",
    "JF": "Jaffa"
  },
  "NL": {
    "MP": "Meppel",
    "DT": "Dronten",
    "AM": "Amsterdam",
    "HW": "Hengelo West",
    "HS": "Hengelo South"
  },
  "SE": {
    "SH1": "Stockholm North",
    "SH2": "Stockholm South",
    "SH3": "Stockholm West"
  },
  "SA": {
    "JD": "Jeddah",
    "RD": "Riyadh",
    "KH": "Khobar"
  },
  "GB": {
    "LND": "London",
    "LND1": "London 1",
    "LND2": "London 2"
  },
  "DE": {
    "FR": "Frankfurt"
  },
  "RU": {
    "MO": "Moscow"
  },
  "FR": {
    "AP": "Aix-en-Provence"
  }
};
window.jdata = window.jdata || {};
window.jdata.features = {
  "WP": "WordPress",
  "MG": "Magento",
  "KB": "Kubernetes",
  "K8B": "Kubernetes",
  "K8S": "Kubernetes",
  "CDN": "Premium CDN",
  "LS": "LiteSpeed",
  "VIP": "VPC Region",
  "VPC": "VPC Region",
  "VP": "VPC Region",
  "CS": "Cloud Storage",
  "DC": "Docker Native"
};
var JApp = window.JApp || {};
$ = $ || jQuery;

window.JApp = function (that) {
  var sDefaultHoster = "eapps",
      sLang = "en",
      sLoadedDefHoster = '',
      PATH_TO_JS = '/wp-content/themes/salient/js/';
  that.COOKIE_EXTERNAL_REFERER = "je-external-referer";
  that.COOKIE_FIRST_EXTERNAL_REFERER = "je-first-external-referer";
  that.COOKIE_UTM_LABELS = "je-utm-labels";
  that.RECAPCHA_KEY = "6LcR2y0UAAAAALs_-g-iuco7GoI2GTFd7rTl_pNe";
  that.userIP;
  that.userCountry;

  that.getLang = function () {
    return sLang;
  };

  that.getDefaultHoster = function () {
    return sLoadedDefHoster || sDefaultHoster;
  };

  that.isLoadedDefHoster = function () {
    return sLoadedDefHoster.length !== 0;
  };

  that.url = {
    getPlatformsInfoHost: function getPlatformsInfoHost() {
      return "//platforms-info.jelastic.com";
    },
    getSignupURL: function getSignupURL() {
      return that.url.getPlatformsInfoHost() + "/api/site/signup";
    },
    getUserDefHosterURL: function getUserDefHosterURL() {
      return that.url.getPlatformsInfoHost() + "/api/user/getdefhoster";
    },
    getUserCountryURL: function getUserCountryURL() {
      return that.url.getPlatformsInfoHost() + "/api/user/getcountry";
    },
    getAppsURL: function getAppsURL() {
      return "//marketplace.jelastic.com/GetApps?search=%7B%22appstore%22:%221%22%7D";
    },
    getInstallAppURL: function getInstallAppURL() {
      return '//go.jelastic.com/InstallApp';
    },
    getHosters: function getHosters() {
      return "//platforms-info.jelastic.com/api/site/GetHosters";
    },
    getCrossApi: function getCrossApi() {
      return that.url.getPlatformsInfoHost() + "/1.0/development/scripting/cross/eval";
    }
  };

  that.loadApps = function (fnCallback) {
    $.ajax({
      type: "GET",
      url: JApp.url.getAppsURL(),
      success: function success(response) {
        var oResp = jQuery.parseJSON(response) || {};

        if (oResp.result == 0 && oResp.response) {
          oResp = oResp.response;
        }

        if (fnCallback) {
          fnCallback(oResp);
        }
      }
    });
  };

  that.loadHosters = function (fnCallback) {
    $.ajax({
      type: "GET",
      url: JApp.url.getHosters(),
      async: true,
      success: function success(response) {
        var oResp = '';

        if (response.result == 0 && response.hosters) {
          oResp = response.hosters;
        }

        if (fnCallback) {
          fnCallback(oResp);
        }
      }
    });
  };

  that.loadDefaultHoster = function (fnCallback, oCriteria) {
    oCriteria = oCriteria || {};
    $.ajax({
      type: "POST",
      url: JApp.url.getUserDefHosterURL(),
      data: {
        criteria: JSON.stringify(oCriteria)
      },
      success: function success(response) {
        var oResp = jQuery.parseJSON(response) || {};

        if (oResp.result == 0 && oResp.response) {
          oResp = oResp.response;
        }

        sLoadedDefHoster = oResp.hoster;

        if (fnCallback) {
          fnCallback();
        }
      },
      error: function error(jqXHR, textStatus, errorThrown) {
        sLoadedDefHoster = sDefaultHoster;

        if (fnCallback) {
          fnCallback();
        }
      }
    });
  };

  that.loadDefHosterByCookie = function (fnCallback, sAvailableHosters) {
    var fnOnResp, nTimeout, availableHosters;
    availableHosters = [];
    $.each(window.hosters, function (i, oHoster) {
      availableHosters[i] = oHoster.keyword;
    });
    availableHosters = availableHosters.join();

    fnOnResp = function fnOnResp(oResponse) {
      clearTimeout(nTimeout);

      if (oResponse && oResponse.result === 0) {
        oResponse = oResponse.response;
      }

      if (oResponse.result === 0) {
        sLoadedDefHoster = oResponse.hoster;
      } else {
        JApp.debug.info("Default hoster did not determined.", oResponse);
      }

      if (fnCallback) {
        fnCallback(sLoadedDefHoster);
      }
    };

    that.utils.CROSSTransport.request(JApp.url.getCrossApi(), {
      script: "api.user.getdefhoster",
      availableHosters: availableHosters,
      forceUserPlatform: true
    }, fnOnResp);
    nTimeout = setTimeout(function () {
      fnOnResp({
        error: "Timeout exceed"
      }, "error");
    }, 5000);
  };

  that.GetUserCountry = function (fnCallback) {
    var sDefault = "N/A";
    $.ajax({
      type: 'POST',
      url: JApp.url.getUserCountryURL(),
      success: function success(sResponse) {
        var oResp = jQuery.parseJSON(sResponse);

        if (oResp.result == 0 && oResp.response.result == 0) {
          fnCallback(oResp.response.country);
          $.cookie('user_country', oResp.response.country);
        } else {
          fnCallback(sDefault);
        }
      },
      error: function error() {
        fnCallback(sDefault);
      }
    });
  };

  that.GetUserIp = function (fnCallback) {
    var sDefaultIP = '127.0.0.1';
    UserInfo.getInfo(function (data) {
      JApp.userIP = data.ip_address;
      JApp.userCountry = data.country.name;
      $.cookie('user_ip', data.ip_address, {
        expires: 7,
        path: '/'
      });
      $.cookie('user_country', data.country.name, {
        expires: 7,
        path: '/'
      });

      if (fnCallback) {
        fnCallback(data.ip_address);
      }
    }, function (err) {
      fnCallback(sDefaultIP);
    });
  };

  that.InstallApp = function (oParams, fnCallback) {
    var data = {
      email: oParams.email,
      app: oParams.appid,
      key: oParams.hoster,
      manifest: oParams.manifest,
      group: oParams.group,
      source: oParams.source,
      iref: document.location.href,
      eref: document.referrer,
      lang: 'en'
    },
        fnCallbackWrap;

    fnCallbackWrap = function fnCallbackWrap(response, textStatus) {
      var oResp = jQuery.parseJSON(response);

      if (fnCallback) {
        fnCallback(oResp);
      }
    };

    $.ajax({
      type: 'POST',
      data: data,
      url: JApp.url.getInstallAppURL(),
      success: fnCallbackWrap,
      error: fnCallbackWrap
    });
  };

  that.jsPath = function () {
    return PATH_TO_JS;
  };

  return that;
}(window.JApp || {});

JApp.utils = function (that) {
  that.toCamelCase = function (str) {
    return str.replace(/\s(.)/g, function (s) {
      return s.toUpperCase();
    }).replace(/\s/g, '').replace(/^(.)/, function (s) {
      return s.toLowerCase();
    });
  };

  that.isValidEmail = function (email) {
    var pattern = /.@./;
    return pattern.test(email);
  };

  that.isValidEmailStrong = function (email) {
    var pattern = /^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])$/i;
    return pattern.test(email);
  };

  that.checkFraudEmail = function (email) {
    var requestIP = '';

    if (JApp.userIP) {
      requestIP = '&userip=' + JApp.userIP;
    }

    var url = '//platforms-info.jelastic.com/api/site/checkfraudemail?email=' + encodeURIComponent(email) + requestIP;
    $.ajax({
      type: "GET",
      url: url,
      success: function success(response) {
        if (response.result != 0) {
          var maxmindBan = '';
          var riskScore = '';
          var risk = '';
          maxmindBan = response.maxmindBan;

          if (maxmindBan) {
            riskScore = response.maxmindResponse.risk_score;
            risk = response.maxmindResponse.ip_address.risk;
          }

          that.SendBadEmailToDB(email, maxmindBan, riskScore, risk);
        }
      },
      error: function error(err) {
        console.warn('err: ', err);
      }
    });
  };

  that.SendBadEmailToDB = function (email, maxmindBan, riskScore, risk) {
    $.ajax({
      url: "/wp-admin/admin-ajax.php",
      data: {
        "action": "add_acae_email",
        "email": email,
        "ip": JApp.userIP,
        "country": JApp.userCountry,
        "maxmindban": maxmindBan,
        "riskscore": riskScore,
        "risk": risk
      },
      method: "POST",
      success: function success(data) {// console.log('response: ', data);
      },
      error: function error(err) {
        console.warn('error: ', err);
      }
    });
  };

  that.cutStr = function (sStr, nMAxLng) {
    var STRING_SEP = ". ",
        aString;
    nMAxLng = nMAxLng || 90;

    if (sStr.length > nMAxLng) {
      aString = sStr.substring(0, nMAxLng).split(STRING_SEP);

      if (aString.length > 1) {
        aString.pop();
        sStr = aString.join(STRING_SEP) + ".";
      } else {
        sStr = sStr.substring(0, nMAxLng - 3) + "...";
      }
    }

    return sStr;
  };

  return that;
}(JApp.utils || {});

JApp.utils.reCaptcha = function () {
  var oLoadCaptcha = $.Deferred();

  window.onReCaptchaLoad = function () {
    oLoadCaptcha.resolve();
  };

  return function (oParams) {
    var me = this,
        sTarget = oParams.target,
        fnChange = function fnChange(sV) {
      sValue = sV;

      if ($.isFunction(me.onChange)) {
        me.onChange(sValue);
      }
    },
        sValue,
        nId;

    me.getValue = function () {
      return sValue;
    };

    me.onChange = oParams.onChange || null;

    me.reset = function () {
      grecaptcha.reset(nId);
    };

    me.getId = function () {
      return nId;
    };

    oLoadCaptcha.done(function () {
      nId = grecaptcha.render(sTarget, {
        sitekey: JApp.RECAPCHA_KEY,
        size: 'invisible',
        callback: fnChange
      });
    });
    return me;
  };
}();

JApp.utils.Modal = function (that) {
  that.errors = {
    TOKEN_TO_SHORT: "Token should consist of 40 symbols",
    INVALID_EMAIL: "The e-mail value is not valid",
    INVALID_DATA: "This field is not valid",
    SOME_ERROR_INSTALL: "Some error has occurred",
    REQUIRED_FIELD: "This field is required"
  };

  that.show = function ($el, oOpt) {
    var nTimeoutId,
        sMsg = oOpt.msg,
        sPos = oOpt.position || 'right',
        nTimeOut = oOpt.hideTime || 5000,
        nWidth = oOpt.width || 220,
        fnHide,
        bAutoHide = oOpt.autoHide || true;

    if (sPos === 'auto') {
      sPos = $(window).width() - $el.offset().left - $el.width() > nWidth ? 'right' : 'bottom';
    }

    fnHide = function fnHide() {
      if (bAutoHide) {
        clearTimeout(nTimeoutId);
      }

      $el.popover('hide');
    }; // $el.popover('destroy');


    $el.popover($.extend(oOpt, {
      placement: sPos,
      trigger: 'manual',
      animation: true,
      content: sMsg
    })).popover('show');

    if (bAutoHide) {
      nTimeoutId = setTimeout(function () {
        $el.popover('hide');
      }, nTimeOut);
    }

    $el.one("focus keypress change").focus(function () {
      fnHide();
    });
  };

  that.hoverShow = function (oEl, oOpt) {
    oEl.hover(function () {
      that.show(oEl, oOpt);
    }, function () {
      oEl.popover("hide");
    });
  };

  that.Massage = function () {
    var $cnt = $('#modal-general'),
        $title = $cnt.find('.title'),
        $msg = $cnt.find('.massage');
    return function (oParams) {
      var oOptions = {
        backdrop: oParams.backdrop || true,
        keyboard: oParams.keyboard || true,
        show: oParams.show || true
      };
      $title.html(oParams.title || '');
      $msg.html(oParams.msg || '');
      $cnt.modal(oOptions);
    };
  }();

  return that;
}(JApp.utils.Modal || {});

JApp.Metrika = function (that) {
  that.EVENTS = {
    SUBMIT_HOSTERS_REQUEST_INFORMATION: "SUBMIT_HOSTERS_REQUEST_INFORMATION",
    SUBMIT_PRIVATE_CLOUD_FREE_TRIAL: "SUBMIT_PRIVATE_CLOUD_FREE_TRIAL",
    SUBMIT_SPECIAL_HOSTER_LANDING: "SUBMIT_SPECIAL_HOSTER_LANDING",
    SUBMIT_LANDING_VPC: "SUBMIT_LANDING_VPC",
    SUBMIT_VIRTUAL_PRIVATE_CLOUD: "SUBMIT_VIRTUAL_PRIVATE_CLOUD"
  };

  that.getCounter = function () {
    return window.yaCounter28600226;
  };

  that.trackSubmitting = function (sEvent, fnCallback, oParams) {
    var oCounter = that.getCounter();

    if (oCounter) {
      oCounter.reachGoal(sEvent, oParams, fnCallback);
    }
  };

  return that;
}(JApp.Metrika || {});

JApp.GA = function (that) {
  var oMetrika = JApp.Metrika;

  that.track = function (oParams) {
    var oOptions = {
      "hitType": "event",
      "eventCategory": oParams.category,
      "eventAction": oParams.action || '',
      "eventLabel": oParams.label || ''
    };

    if (Object.prototype.hasOwnProperty.call(oParams, "value")) {
      oOptions.eventValue = oParams.value;
    }

    if (!!oParams.redirect) {
      oOptions.hitCallback = function () {
        setTimeout(function () {
          window.location.href = oParams.redirect;
        }, 50);
      };
    }

    JApp.debug.info("Track GA", oOptions);

    if (window.ga) {
      ga("send", oOptions);
    }

    if (oOptions.hitCallback) {
      if (window.ga) {
        setTimeout(oParams.hitCallback, 1500);
      } else {
        oOptions.hitCallback();
      }
    }
  };

  that.trackSelectApp = function (appid) {
    that.track({
      category: 'Marketplace',
      action: 'Marketplace-Select-App',
      label: appid
    });
  };

  that.trackInstallApp = function (appid, nComplete) {
    that.track({
      category: 'Marketplace',
      action: 'Marketplace-Install-' + nComplete === 0 ? 'Success' : 'Error',
      label: appid
    });
  };

  that.trackSubscribe = function (sEmail) {
    that.track({
      category: 'Subscribe',
      action: that.getDomainSource(),
      email: sEmail
    });
  };

  that.trackPrivateCloudEmail = function (sValue) {
    that.trackFormSubmitting('Private-Cloud', sValue);
    oMetrika.trackSubmitting(oMetrika.SUBMIT_PRIVATE_CLOUD_FREE_TRIAL);
  };

  that.trackPrivateLandingEmail = function (sValue) {
    that.trackFormSubmitting('Private-Landing', sValue);

    if (window.fbq) {
      window.fbq('track', 'CompleteRegistration');
    }

    oMetrika.trackSubmitting(oMetrika.SUBMIT_HOSTERS_REQUEST_INFORMATION);
  };

  that.trackHosterCloudFreeTrial = function (sValue) {
    that.trackFormSubmitting('Hosters-Trial-Request', sValue);
  };

  that.trackFormSubmitting = function (sForm, sValue, sRedirect) {
    that.track({
      category: "Submit-form",
      action: sForm,
      label: sValue,
      redirect: sRedirect
    });
  };

  that.trackSubmitRequestVPC = function (sValue) {
    that.trackFormSubmitting('VPC', sValue);
    oMetrika.trackSubmitting(oMetrika.SUBMIT_VIRTUAL_PRIVATE_CLOUD);
  };

  that.trackSubmitAboutEvents = function (sValue) {
    that.trackFormSubmitting('About-Events', sValue);
  };

  that.trackSubmitLandingVPC = function (sValue) {
    that.trackFormSubmitting('Landing-VPC', sValue);
    oMetrika.trackSubmitting(oMetrika.SUBMIT_LANDING_VPC);
  };

  that.trackSubmitPacketLanding = function (sValue) {
    that.trackFormSubmitting('Packet-Landing', sValue);
    oMetrika.trackSubmitting(oMetrika.SUBMIT_SPECIAL_HOSTER_LANDING);
  };

  that.trackSignupSuccess = function (sHoster, sLink) {
    var sDefault = JApp.isLoadedDefHoster() ? JApp.getDefaultHoster() : "notDefined";
    that.track({
      category: "signup",
      action: sHoster,
      label: sDefault + " >> " + sHoster,
      redirect: sLink
    });
  };

  that.trackSignupError = function (sHoster, sMsg) {
    that.track({
      category: "signup-error",
      action: sHoster,
      label: sMsg
    });
  };

  that.trackPageview = function (sPage, sTitle) {
    if (window.ga) {
      window.ga('send', 'pageview', {
        'page': sPage,
        'title': sTitle || ''
      });
    }
  };

  that.getDomainSource = function () {
    var sDomain = window.location.host,
        sSubDomain = sDomain.replace(".jelastic.com", ""),
        sSource = "Jelastic";

    if (sSubDomain !== sDomain) {
      sSource += "-" + JApp.utils.toCamelCase(sSubDomain);
    }

    return sSource;
  };

  return that;
}(JApp.GA || {});

JApp.bind = function (that) {
  var $body = $('body');

  that.miss = function (sTarget, callback) {
    $body.on('click.miss', function (e) {
      if (e.originalEvent && $(e.target).closest(sTarget).length === 0) {
        if (callback() === false) {
          $body.off('click.miss');
          return false;
        }
      }
    });
  };

  return that;
}(JApp.bind || {});

JApp.user = function (that) {
  that.signupErrors = {
    UNKNOWN: "Something went wrong. We suspect this was caused by network issues, so please try again in a few minutes. If your second attempt fails, please, email us at <a href='mailto:info@jelastic.com'>info@jelastic.com</a> to get the assistance with account creation.",
    ERROR_EMAIL: "The specified email address is not allowed for registration. Please use another email or contact us at <a href='mailto:info@jelastic.com'>info@jelastic.com</a> for the assistance.",
    EMAIL_DENY: "The specified email address is not allowed for registration. Please use another email or contact us at <a href='mailto:info@jelastic.com'>info@jelastic.com</a> for the assistance."
  };

  that.Signup = function (oData, sCurrentHoster, ops) {
    var oParams,
        oLocation = window.location,
        sReferrer = oLocation.href,
        sError,
        fCallback,
        bRedirect,
        sMarketingSource = JApp.GA.getDomainSource();

    if (document.referrer) {
      sReferrer += (oLocation.search ? "&" : "?") + "referrer=" + document.referrer;
    }

    function trackGA(success, sMsg, sLink) {
      sMsg = sMsg || "unknown";

      if (success === false) {
        JApp.GA.trackPageview("/signup/error");
        JApp.GA.trackSignupError(sCurrentHoster, sMsg);
      } else {
        JApp.GA.trackPageview("/signup/success");
        JApp.GA.trackSignupSuccess(sCurrentHoster, sLink);
      }
    }

    ops = ops || {};
    fCallback = ops.callback;
    bRedirect = ops.redirect !== false;
    oParams = JSON.stringify({
      "name": oData.name,
      "email": oData.email,
      "comment": oData.comment,
      "verifyKey": oData.verifyKey,
      "hoster": sCurrentHoster,
      "referrer": sReferrer,
      "marketing_source": sMarketingSource,
      "source": sMarketingSource,
      "lang": JApp.getLang() || String(navigator.language || navigator.browserLanguage).toLowerCase(),
      "ext_referrer": $.cookie(JApp.COOKIE_EXTERNAL_REFERER),
      "utm_label": $.cookie(JApp.COOKIE_UTM_LABELS)
    });
    $.ajax({
      type: "POST",
      url: JApp.url.getSignupURL(),
      data: {
        "data": oParams
      },
      success: function success(response) {
        var oResp = jQuery.parseJSON(response),
            bSuccess = true,
            nResult = oResp.result,
            sMsg;

        if (oResp && nResult == 0 && oResp.response) {
          oResp = oResp.response;
          nResult = oResp.result;
        }

        if (!oResp || nResult != 0) {
          bSuccess = false;
        }

        if (bSuccess === false) {
          oResp = oResp || "Response is undefined";
          sMsg = JSON.stringify(oResp);

          switch (nResult) {
            case 501:
              sError = that.signupErrors.ERROR_EMAIL;
              break;

            case 508:
              sError = that.signupErrors.EMAIL_DENY;
              break;

            case 10008:
              sError = that.signupErrors.EMAIL_DENY;
              JApp.utils.checkFraudEmail(oData.email);
              break;

            default:
              sError = that.signupErrors.UNKNOWN;
          }

          JApp.utils.Modal.Massage({
            title: "Registration failed",
            msg: sError
          });
        }

        trackGA(bSuccess, sMsg, String(oResp.app).indexOf("?") > -1 ? oResp.app : oResp.app + '?signup=' + oResp.email);

        if (fCallback) {
          fCallback(bSuccess, nResult);
        }
      },
      error: function error(oJqXHR, textStatus, errorThrown) {
        console.log(1);
        JApp.utils.Modal.Massage({
          title: "Registration failed",
          msg: that.signupErrors.UNKNOWN
        });
        trackGA(false, (textStatus || "error") + ": " + (oJqXHR.status || "") + (errorThrown || "unknown"));

        if (fCallback) {
          fCallback(false);
        }
      }
    });
  };

  that.subscribe = function (sUrl, oData, fnCallback) {
    $.ajax({
      type: "POST",
      url: sUrl,
      data: oData,
      complete: function complete(oResponse) {
        var oResp = jQuery.parseJSON(oResponse.responseText),
            nResult = oResp.result;

        if (oResp && oResp.result == 0) {
          JApp.GA.trackSubscribe(oData.email);
        }

        if (fnCallback) {
          fnCallback(nResult);
        }
      }
    });
  };

  return that;
}(JApp.user || {});

JApp.debug = function (that) {
  var bDebug = !!window.debugMode;

  that.log = function () {
    if (bDebug) {
      console.log.apply(console, arguments);
    }
  };

  that.info = function () {
    if (bDebug) {
      console.info.apply(console, arguments);
    }
  };

  return that;
}(JApp.debug || {});

jQuery(document).ready(function ($) {
  var jCalculator = function jCalculator(el) {
    _classCallCheck(this, jCalculator);

    this.calculatorElement = el;
  };

  var calculatorTag = $('.j-calculator'),
      sHtml = '',
      sCurrentHoster = 'servint',
      bInitDefCor,
      fnSetDefault,
      fnInitDefaultHoster,
      oHosters = [],
      pricing = '',
      currency = ''; // CLASSES

  var hSelectBlockClass = '.hoster-selector',
      hSelectClass = '.hoster-selector--select',
      calculatorBlockClass = '.calculator-wrapper',
      sCssLoading = 'loading';

  function getPricing() {
    $.ajax({
      type: "GET",
      url: 'http://platforms-info.jelastic.com/api/GetPricings',
      dataType: "json",
      success: function success(pricingJSON) {
        if (pricingJSON.result === 0) {
          window.pricing = pricingJSON.response.pricings;
          fnSetDefault();
        }
      }
    });
  }

  function getCurrency() {
    $.ajax({
      type: "GET",
      url: 'http://platforms-info.jelastic.com/api/GetCurrency',
      dataType: "json",
      success: function success(currencyJSON) {
        if (currencyJSON.result === 0) {
          window.currency = currencyJSON.response.objects;
        }
      }
    });
  }

  getCurrency();
  getPricing();
  $(calculatorTag).addClass(sCssLoading);

  function uniqid() {
    var a = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "";
    var b = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    var c = Date.now() / 1000;
    var d = c.toString(16).split(".").join("");

    while (d.length < 14) {
      d += "0";
    }

    var e = "";

    if (b) {
      e = ".";
      var f = Math.round(Math.random() * 100000000);
      e += f;
    }

    return a + d + e;
  }

  function renderHosterSelector(el) {
    sHtml = new EJS({
      url: '/j-calculator/templates/hoster-selector'
    }).render({
      hSelectBlockClass: hSelectBlockClass.replace('.', ''),
      hSelectClass: hSelectClass.replace('.', ''),
      txChoose: 'Choose Service Provider of Jelastic Public Cloud',
      txPerfomance: 'Perfomance',
      txSupport: 'Support',
      txLocation: 'Location',
      txServices: 'Advanced Services',
      defHoster: sCurrentHoster,
      hosters: oHosters
    });

    for (var i = 0, oHoster; oHoster = oHosters[i]; i++) {
      if (sCurrentHoster === oHoster.keyword) {
        $(el).attr('data-key', oHoster.key);
        $(el).attr('data-currency', oHoster.currencyCode);
      }
    }

    if ($(el).find(hSelectBlockClass).length > 0) {
      $(el).find(hSelectBlockClass).replaceWith(sHtml);
    } else {
      $(el).append(sHtml);
    }

    $(el).find('select').each(function () {
      var $this = $(this),
          numberOfOptions = $(this).children('option').length;
      $this.addClass('select-hidden');
      $this.wrap('<div class="select"></div>');
      $this.after('<div class="select-styled"></div>');
      var $styledSelect = $this.next('div.select-styled');
      $styledSelect.text($this.children('option:selected').text());
      var $list = $('<ul />', {
        'class': 'select-options'
      }).insertAfter($styledSelect);

      for (var i = 0; i < numberOfOptions; i++) {
        $('<li />', {
          text: $this.children('option').eq(i).text(),
          rel: $this.children('option').eq(i).val()
        }).appendTo($list);
      }

      var $listItems = $list.children('li');
      $styledSelect.click(function (e) {
        e.stopPropagation();
        $('div.select-styled.active').not(this).each(function () {
          $(this).removeClass('active').next('ul.select-options').hide();
        });
        $(this).toggleClass('active').next('ul.select-options').toggle();
      });
      $listItems.click(function (e) {
        e.stopPropagation();
        $styledSelect.text($(this).text()).removeClass('active');
        $this.val($(this).attr('rel')).change();
        $list.hide();
      });
      $(document).click(function () {
        $styledSelect.removeClass('active');
        $list.hide();
      });
    });
    $(calculatorTag).removeClass(sCssLoading);
  }

  function renderCalculator(el) {
    var oLanguages = ['java', 'php', 'node', 'ruby', 'python', 'go'],
        fixed = '',
        dynamic = '',
        minPrice = '',
        maxPrice = '',
        usdRate = 1;
    sHtml = new EJS({
      url: '/j-calculator/templates/calculator'
    }).render({
      calculatorBlockClass: calculatorBlockClass.replace('.', ''),
      oLanguages: oLanguages
    });

    if ($(el).find(calculatorBlockClass).length > 0) {
      $(el).find(calculatorBlockClass).replaceWith(sHtml);
    } else {
      $(el).append(sHtml);
    }

    var sKey = window.pricing[$(el).attr('data-key')],
        hosterCurrency = $(el).attr('data-currency'),
        tariffPlans = sKey.tariffPlans;

    if (tariffPlans.length > 0) {
      $.each(tariffPlans, function () {
        if (this.type.toLowerCase() === 'fixed') {
          fixed = this;
        }

        if (this.type.toLowerCase() === 'flexible') {
          dynamic = this;
        }
      });
    }

    $.each(window.currency, function () {
      if (this.code === hosterCurrency) {
        usdRate = this.usdRate;
      }
    });
    var range = $(el).find('.range').slider({
      animate: "fast",
      range: true,
      min: fixed.minCloudletCount,
      max: 128,
      values: [1, 120],
      change: function change(event, ui) {
        setMinValues(ui.values[0], range);
        setMaxValues(ui.values[1], range);
        minPrice = checkPrice(ui.values[0], fixed.tiers); // checkPrice(ui.values[1], dynamic.tiers);
      },
      slide: function slide(event, ui) {
        setMinValues(ui.values[0], range);
        setMaxValues(ui.values[1], range);
        console.log(checkPrice(ui.values[0], fixed.tiers)); // checkPrice(ui.values[1], dynamic.tiers);
      }
    });
    console.log(fixed.tiers);
    minPrice = checkPrice(range.slider("values", 0), fixed.tiers);
    maxPrice = checkPrice(range.slider("values", 1), dynamic.tiers);
    setMinValues(range.slider("values", 0), range, fixed.tiers, usdRate);
    setMaxValues(range.slider("values", 1), range, dynamic.tiers, usdRate); // $(el).on('click', '.min-block-decrease', function (e) {
    //     range.slider('values', [(range.slider("values", 0) - 1), range.slider("values", 1)]);
    // });
    // $(el).on('click', '.max-block-decrease', function (e) {
    //     if ((range.slider("values", 0)) < range.slider("values", 1)) {
    //         range.slider('values', [(range.slider("values", 0)), range.slider("values", 1) - 1]);
    //     }
    // });
    // $(el).on('click', '.min-block-increase', function (e) {
    //     if ((range.slider("values", 0) + 1) <= range.slider("values", 1)) {
    //         range.slider('values', [(range.slider("values", 0) + 1), range.slider("values", 1)]);
    //     }
    // });
    // $(el).on('click', '.max-block-increase', function (e) {
    //     range.slider('values', [(range.slider("values", 0)), range.slider("values", 1) + 1]);
    // });
    // $(el).on('click', '.plus', function (e) {
    //     var digit = $(this).closest('.inner').find('.digit');
    //     digit.text(parseInt(digit.text()) + 1);
    // });
    // $(el).on('click', '.minus', function (e) {
    //     var digit = $(this).closest('.inner').find('.digit');
    //     if (parseInt(digit.text()) > 0) {
    //         digit.text(parseInt(digit.text()) - 1);
    //     }
    // });

    $(calculatorTag).removeClass(sCssLoading);
  }

  function convertMib(value) {
    value *= 128;
    return value > 1000 ? parseFloat(value / 1000).toFixed(2) + " GiB" : value + " MiB";
  }

  function convertMhz(value) {
    value *= 400;
    return value > 1000 ? parseFloat(value / 1000).toFixed(2) + " MHz" : value + " GHz";
  }

  function changePricePeriod(sPeriod, sValue) {
    switch (sPeriod) {
      case 'hourly':
        sValue = sValue * 730;
        break;

      case 'monthly':
        sValue = sValue * 1000 / 1000;
        break;
    }

    return sValue;
  }

  function checkPrice(value, tiers) {
    var price = tiers[0].price;

    for (var i = 0; i < tiers.length; i++) {
      if (!tiers[i + 1]) {
        price = tiers[tiers.length - 1].price;
      } else {
        if (value >= tiers[i].value && value < tiers[i + 1].value) {
          price = tiers[i].price;
          return price;
        }
      }
    }

    return price;
  }

  function setMinValues(value, el) {
    // render line from dot to range
    var leftRange = $(el).closest(calculatorTag).find('.ui-slider-handle:first-of-type');
    var distance = leftRange.offset().left - $('.reserved .dot').offset().left + $('.reserved .dot').outerWidth() + 10;

    if (distance > 0) {
      $('.reserved .dot').html('<span class="line more" style="width:' + distance + 'px"></span>');
    } else {
      $('.reserved .dot').html('<span class="line less" style="width:' + Math.abs(distance) + 'px"></span>');
    } // change reserved cloudlets


    var mib = convertMib(value);
    var mhz = convertMhz(value);
    $(el).closest(calculatorTag).find('.min-block .digits').html('<span>' + mib + '</span><span>' + mhz + '</span>');
  }

  function setMaxValues(value, el) {
    // render line from dot to range
    var rightRange = $(el).closest(calculatorTag).find('.ui-slider-handle:last-of-type');
    var distance = rightRange.offset().left - $('.sl .dot').offset().left + $('.sl .dot').outerWidth() + 10;

    if (distance > 0) {
      $('.sl .dot').html('<span class="line more" style="width:' + distance + 'px"></span>');
    } else {
      $('.sl .dot').html('<span class="line less" style="width:' + Math.abs(distance) + 'px"></span>');
    } // change scaling limits


    var mib = convertMib(value);
    var mhz = convertMhz(value);
    $(el).closest(calculatorTag).find('.max-block .digits').html('<span>' + mib + '</span><span>' + mhz + '</span>');
  }

  fnSetDefault = function fnSetDefault() {
    var sHosterCriteria = uniqid();

    if (JApp.isLoadedDefHoster()) {
      return fnInitDefaultHoster();
    } else {
      return JApp.loadDefaultHoster(fnInitDefaultHoster, sHosterCriteria);
    }

    bInitDefCor = false;
  };

  fnInitDefaultHoster = function fnInitDefaultHoster(sHoster) {
    sCurrentHoster = sHoster || JApp.getDefaultHoster();
    JApp.loadHosters(function (hosters) {
      oHosters = hosters;

      if (calculatorTag.length > 0) {
        $.each(calculatorTag, function (e) {
          renderHosterSelector($(this));
          renderCalculator($(this));
        });
      }
    });
  };

  $(document).on('change', hSelectClass, function (e) {
    var calculatorElement = $(this).closest(calculatorTag);
    sCurrentHoster = $(this).val();
    renderHosterSelector(calculatorElement);
    renderCalculator(calculatorElement);
  });
});